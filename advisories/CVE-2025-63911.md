# CVE-2025-63911: CLISH Command Injection in Cohesity TranZman

## Overview

| Field | Value |
| --- | --- |
| CVE ID | CVE-2025-63911 |
| CVSS v3.1 | 7.2 (High) |
| Vector | AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H |
| CWE | CWE-78: OS Command Injection |
| Vendor | Cohesity, Inc. |
| Product | TranZman Migration Appliance |
| Affected Versions | Release 4.0 Build 14614 including patch TZM_1757588060_SEP2025_FULL.depot |

## Description

An authenticated command injection vulnerability exists in the CLISH
(Command Line Interface Shell) restricted shell of Cohesity TranZman
Migration Appliance. The vulnerability arises from insufficient input
validation in the CLISH configuration, specifically:

- `/etc/clish/types.xml` - STRING parameter type with overly permissive regex
- `/etc/clish/config-view.xml` - personality command definition
- Multiple command definitions with unquoted variable expansions

An authenticated admin user can inject shell metacharacters through
vulnerable commands to escape the restricted shell and gain unrestricted
system access.

## Attack Vector

1. Authenticated admin user connects via SSH
2. Access the CLISH menu system
3. Inject shell metacharacters (`;`, `|`, `$`) through vulnerable commands

Example payloads:

```bash
personality red;/bin/bash
load_media ;/bin/bash;
```

This escapes the restricted shell environment, granting unrestricted bash
access as the `admin` user (uid=1000). While not root, this user operates
in an unconfined SELinux context and can leverage further vulnerabilities
(CVE-2025-63909) for privilege escalation.

## Impact

- Shell Escape: Bypass CLISH restricted shell confinement
- Privilege Escalation: Combined with CVE-2025-63909, achieves root access
- System Compromise: Full control of the TranZman appliance
- Lateral Movement: Potential access to connected NetBackup infrastructure

## Remediation

Apply Cohesity patches in the following order:

1. `TZM_patch_1.patch`
2. `TZM_1760106063_OCT2025R2_FULL.depot`

Contact Cohesity support for the latest OVA version with integrated fixes.

## Timeline

| Date | Event |
| --- | --- |
| 26 September 2025 | Reported to Cohesity |
| 20 October 2025 | Cohesity confirmed fix in patches |
| 25 December 2025 | Embargo period ended |
| 27 December 2025 | Public disclosure |

## Credit

Discovered by Greg Durys, LME

## References

- [MITRE CVE Record](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-63911)
- [CWE-78: OS Command Injection](https://cwe.mitre.org/data/definitions/78.html)
- [OWASP Command Injection](https://owasp.org/www-community/attacks/Command_Injection)
