# CVE-2025-63910: Unsigned Patch Upload in Cohesity TranZman

## Overview

| Field | Value |
| --- | --- |
| CVE ID | CVE-2025-63910 |
| CVSS v3.1 | 7.2 (High) |
| Vector | AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H |
| CWE | CWE-345: Insufficient Verification of Data Authenticity |
| Vendor | Cohesity, Inc. |
| Product | TranZman Migration Appliance |
| Affected Versions | Release 4.0 Build 14614 including patch TZM_1757588060_SEP2025_FULL.depot |

## Description

An authenticated arbitrary file upload vulnerability in Cohesity TranZman
Migration Appliance allows attackers with Administrator privileges to
execute arbitrary code via uploading a crafted patch file.

The appliance's patch upload and deployment mechanism lacks cryptographic
signature verification, accepting and executing unsigned patches.
This represents a critical security design flaw in the update mechanism,
allowing remote attackers with admin credentials to deploy malicious
patches that execute arbitrary code with system privileges.

## Technical Details

The Flask application at `/opt/SRLtzm/web/tranzman/views/patch.py`
provides three routes:

- `GET /patch` - Lists available patches from `/data/patches/` directory
- `POST /patch` - Uploads patches to the patches directory
- `PATCH /patch` - Applies patches via `run_independent_script_sbin()`

Patch decryption uses OpenSSL with a static key:

```text
openssl aes-256-cbc -d -pbkdf2 -md md5 -in <patch_file> \
  -kfile /opt/SRLtzm/srltzm.bmp
```

Key observations:

- All patches use AES-256-CBC encryption with PBKDF2 key derivation
- The encryption key is stored in a static BMP file at
  `/opt/SRLtzm/srltzm.bmp`
- The same key is used for all patches across all installations
- No digital signatures or integrity checks are performed
- Decrypted content is piped directly into `tar -zx`

The static key can be obtained through CLISH command injection, hypervisor
access to the OVA, or other means - enabling attackers to craft and
encrypt their own malicious patches.

## Attack Vector

1. Authenticated admin user accesses patch management interface (web UI or CLI)
2. Upload a maliciously crafted patch file
3. System accepts the unsigned patch without cryptographic verification
4. Patch is executed with system privileges

Attack chain:

```text
Admin Login -> Patch Upload Interface -> Upload Malicious Patch -> Code Execution
```

The patch file format allows embedding arbitrary scripts that execute
during the patch deployment process.

## Impact

- Remote Code Execution: Arbitrary code execution with system privileges
- Supply Chain Risk: Malicious patches could be distributed to multiple appliances
- Persistence: Patches modify system files, enabling persistent backdoors
- Full System Compromise: Complete control of the TranZman appliance

## Remediation

Apply Cohesity patches in the following order:

1. `TZM_patch_1.patch`
2. `TZM_1760106063_OCT2025R2_FULL.depot`

Contact Cohesity support for the latest OVA version with integrated fixes.

## Timeline

| Date | Event |
| --- | --- |
| 26 September 2025 | Reported to Cohesity |
| 20 October 2025 | Cohesity confirmed fix in patches |
| 25 December 2025 | Embargo period ended |
| 27 December 2025 | Public disclosure |

## Credit

Discovered by Greg Durys, LME

## References

- [MITRE CVE Record](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-63910)
- [CWE-345: Insufficient Verification of Data Authenticity](https://cwe.mitre.org/data/definitions/345.html)
